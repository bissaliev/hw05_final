{% extends "base.html" %}
{% load thumbnail %}
{% load static %}
{% block title %}
  <title> {{ post.text|truncatechars:30 }} </title>
{% endblock%}
{% block content %}
<div class="container"> <!--top-->
    <div class="row post_single_des justify-content-around ">
        <div class="col-12 col-md-4 col-lg-5 p-3 p-lg-5"> <!--img-->
            {% if post.image %}
              {% thumbnail post.image "500x600" crop="center" upscale=True as im %}
                <img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}" class="img-fluid post_single_img">
              {% endthumbnail %}
            {% else %}
              <img src="{% static 'img/default_img.png' %}" width="500" height="600" class="img-fluid post_single_img">
            {% endif %}
        </div>
        <div class="col-12 col-md-8 col-lg-7 pt-lg-5"> <!--description-->
            <h3 class="h3">{{ post.text|truncatechars:100 }}</h3>
            <p>{{ post.pub_date|date:"d E Y"}}</p>
            {% if post.group %}
            <a class="btn post_single_group_name my-3" href="{% url 'posts:group_list' post.group.slug %}">{{ post.group.title }}</a>
            {% endif%}
            <div>
            <div class="d-flex align-items-end ">
                {% if post.author.avatar %}
                    {% thumbnail post.author.avatar "80x80" crop="center" upscale=True as im %}
                    <img src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}" class="post_single_avatar" href="{% url 'posts:profile' post.author.username %}">
                    {% endthumbnail %}
                {% else %}
                    <img src="/media/users/default.png" width="70" height="70" class="img-fluid post_single_avatar">
                {% endif %}
                <div class="ms-2">
                    <h5 class="post_single_author_name"><a href="{% url 'posts:profile' post.author.username %}">{{ post.author.get_full_name }}</a></h5>
                    <small>Всего постов автора:  <span > {{ post.author.posts.count }}</span></small>
                </div>
            </div>
            <a class="btn btn-dark btn-lg mt-3" href="#" role="button">Подписаться</a>
        </div>
    </div>
</div>
<div class="container post_single_text p-3 p-lg-5">  <!--text-->
    {{ post.text|linebreaksbr }}
</div>
<div class="container mt-5"> <!--button-->
    <div class="d-flex justify-content-around">
        {% if request.user.is_authenticated %}
        <a class="btn btn-primary btn-lg" href="{% url 'posts:post_edit' post.id %}">редактировать</a>
        {% endif%}
        {% if request.user.is_authenticated %}
        <a class="btn btn-danger btn-lg" href="{% url 'posts:post_delete' post.id %}">удалить</a>
        {% endif%}
    </div>
</div> <!--button-->
<div class=""> <!--comments-->
    {% include 'includes/comments.html' %}
</div>
{% endblock %}
